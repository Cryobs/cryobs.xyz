1. install packets
sudo pacman -S php mariadb curl unzip php-fpm nginx
(runit)
sudo pacman -S nginx-runit php-fpm-runit

2. install php composer
php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
php composer-setup.php
php -r "unlink('composer-setup.php');"
sudo mv composer.phar /usr/local/bin/composer

3. install composer packages (in site dir)
composer require vlucas/phpdotenv

4. setup php extensions
sudo -E nvim /etc/php/php.ini
(find ";extension=pdo_mysql" uncomment it)

5. setup 
(systemd)
sudo systemctl enable mariadb
sudo systemctl enable php-fpm
sudo systemctl enable nginx

(runit)
sudo ln -s /etc/runit/sv/nginx /run/runit/service
sudo ln -s /etc/runit/sv/mariadb /run/runit/service
sudo ln -s /etc/runit/sv/php-fpm /run/runit/service


6. create db
sudo mariadb-install-db
sudo mariadb -u root -p
CREATE DATABASE cryobs_xyz;
USE cryobs_xyz;
CREATE TABLE site_stats (
  id INT AUTO_INCREMENT PRIMARY KEY,
  visits INT NOT NULL DEFAULT 0
);
INSERT INTO site_stats (visits) VALUES (0);
exit;

7. create .env
DB_HOST=
DB_NAME=
DB_USER=
DB_PASS=
SITE_DIR=

8. setup nginx
sudo nvim -E /etc/nginx/nginx.conf
(in http {})

server {
    listen       80;
    server_name  localhost;

    root   /home/cryobs/cryobs.xyz; # your site dir
    index  index.php index.html index.htm;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        include fastcgi_params;
        fastcgi_pass unix:/run/php-fpm/php-fpm.sock;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }

9. start 
(systemd)
sudo systemctl restart nginx

(runit)
sudo sv restart nginx
